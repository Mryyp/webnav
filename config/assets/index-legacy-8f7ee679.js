System.register(["./index-legacy-a99c9020.js","./scenes-legacy-4312c495.js","./_plugin-vue_export-helper-legacy-81237f8a.js","./index-legacy-9da69aad.js","./index-legacy-e3a7fdfb.js","./index-legacy-72b87ffe.js","./index-legacy-c9ba97df.js","./project-legacy-4cbbb44a.js","./index-legacy-80e98bda.js","./request-legacy-92f25d7d.js","./dialog-legacy-b3058717.js","./utils-legacy-dc7aece1.js","./index-legacy-d43907dc.js","./index-legacy-68f7e69d.js","./index-legacy-eba374c8.js","./index-legacy-83c576b6.js","./use-route-legacy-499fde2a.js","./use-id-legacy-6fdeb452.js"],(function(e,l){"use strict";var a,n,o,t,i,s,d,c,u,m,r,v,y,p,h,g,_,f,k,w,b,x,C,I,W,S,j,q,M,V,D,E,F,N,U,B,z,P,O,L,A,J,G,R,T,$,H,K,Q,X;return{setters:[e=>{a=e.d,n=e.x,o=e.i,t=e.R,i=e.n,s=e.c,d=e.e,c=e.ai,u=e.f,m=e.F,r=e.I,v=e.o,y=e.b,p=e.g,h=e.t,g=e.y,_=e.p,f=e.h,k=e.r,w=e.j,b=e.w,x=e.G,C=e.s,I=e.ah,W=e.v,S=e.u},e=>{j=e.D,q=e._,M=e.T,V=e.S,D=e.B,E=e.L},e=>{F=e.I,N=e._,U=e.N},e=>{B=e.S},e=>{z=e.L,P=e.P},null,e=>{O=e.F},e=>{L=e.p},e=>{A=e.P},e=>{J=e.s,G=e.b,R=e.c,T=e.d},e=>{$=e.D},e=>{H=e.f},e=>{K=e.a,Q=e.S},e=>{X=e.I},null,null,null,null],execute:function(){const l=e=>(_("data-v-45f439ac"),e=e(),f(),e),Y={class:"inventory"},Z={class:"table"},ee={class:"header"},le={class:"top"},ae=["onClick"],ne={key:0},oe=["src"],te={key:0},ie={key:0,class:"bbox"},se=l((()=>d("div",{class:"bname"}," 主要信息： ",-1))),de={class:"vhtml"},ce={key:1,class:"bbox"},ue=l((()=>d("div",{class:"bname"}," 备注说明： ",-1))),me={class:"vhtml"},re=a({__name:"inventory",props:{columns:{}},setup(e){const l=e,{columns:a}=n(l),_=a.value.map((()=>o(null))),f=e=>l=>{_[e].value=l},k=t((()=>{const e=_.map((e=>e.value?[e.value.querySelector(".col1")?.clientWidth||0,e.value.querySelector(".col2")?.clientWidth||0,e.value.querySelector(".col3")?.clientWidth||0,e.value.querySelector(".col4")?.clientWidth||0,e.value.querySelector(".col5")?.clientWidth||0]:[0,0])),l=Math.max(...e.map((([e])=>e))),a=Math.max(...e.map((([,e])=>e))),n=Math.max(...e.map((([,,e])=>e))),o=Math.max(...e.map((([,,,e])=>e))),t=Math.max(...e.map((([,,,,e])=>e)));return[l,a,n,o,t,l+a+n+o+t+3]})),w=o(!1);return i((()=>{w.value=!0})),(e,l)=>{const n=F;return v(),s("div",Y,[d("ul",Z,[d("li",ee,[d("div",le,[d("div",{ref:"col1",style:c({width:u(w)?u(k)[0]/100+"rem":"auto"})}," 产品类别 ",4),d("div",{ref:"col2",style:c({width:u(w)?u(k)[1]/100+"rem":"auto"})}," 品牌 ",4),d("div",{ref:"col3",style:c({width:u(w)?u(k)[2]/100+"rem":"auto"})}," 缩略图 ",4),d("div",{ref:"col4",style:c({width:u(w)?u(k)[3]/100+"rem":"auto"})}," 售价/单位 ",4),d("div",{ref:"col5",style:c({width:u(w)?u(k)[4]/100+"rem":"auto"})}," 数量 ",4)])]),(v(!0),s(m,null,r(u(a),((e,l)=>(v(),s("li",{key:l,ref_for:!0,ref:"columnDivs",class:"body"},[d("div",{ref_for:!0,ref:f(l),class:"top",onClick:l=>(e=>{e.on=!e.on})(e)},[d("div",{class:"col1",style:c({width:u(w)?u(k)[0]/100+"rem":"auto"})},[y(n,{class:"icon",name:e.on?"arrow-up":"arrow-down",size:"0.08rem",color:"#293644"},null,8,["name"]),p(" "+h(e.name),1)],4),d("div",{class:"col2",style:c({width:u(w)?u(k)[1]/100+"rem":"auto"})},[e.product.length?(v(),s("span",ne,h(e.product[0].brand),1)):g("",!0)],4),d("div",{class:"col3",style:c({width:u(w)?u(k)[2]/100+"rem":"auto"})},[e.product.length?(v(),s("img",{key:0,class:"shopImg",src:e.product[0].img},null,8,oe)):g("",!0)],4),d("div",{class:"col4",style:c({width:u(w)?u(k)[3]/100+"rem":"auto"})},[e.product.length?(v(),s("span",te," ¥"+h(e.product[0].price/100)+"/"+h(e.product[0].unit),1)):g("",!0)],4),d("div",{class:"col5",style:c({width:u(w)?u(k)[4]/100+"rem":"auto"})},h(e.num),5)],8,ae),e.on?(v(),s("div",{key:0,class:"bottom",style:c({width:u(w)?u(k)[5]/100+"rem":"100%"})},[e.product.length?(v(),s("div",ie,[se,d("div",de,h(e.product[0].extra),1)])):g("",!0),e.product.length?(v(),s("div",ce,[ue,d("div",me,h(e.product[0].remark),1)])):g("",!0)],4)):g("",!0)])))),128))])])}}}),ve=N(re,[["__scopeId","data-v-45f439ac"]]),ye={class:"main"},pe=(e=>(_("data-v-ab477a50"),e=e(),f(),e))((()=>d("div",{class:"tips"}," 插入产品 ",-1))),he={class:"main_main"},ge={class:"footer"},_e={key:1},fe=N(a({__name:"project",props:{id:{}},emits:["doSth"],setup(e,{expose:l,emit:a}){const t=e,i=o(!1),{id:c}=n(t),m=k({name:"",type:""}),r=k({name:null,type:null,number:null}),p=o(!1),h={text:"name",value:"id"},_=({selectedOptions:e})=>{m.name=e[0]?.name,r.name=e[0]?.id,m.type="",r.type=null,p.value=!1,q()},f=o([]),C=async()=>{m.name="",m.type="",r.name=null,r.type=null,r.number=null;const e=await L.cates({orderId:c.value});0===e.code&&(f.value=e.data)},I=o(!1),W={text:"name",value:"id"},S=({selectedOptions:e})=>{m.type=e[0]?.name,r.type=e[0]?.id,I.value=!1;const l=j.value.findIndex((e=>e.id===r.type));0!==l&&-1!==l&&j.value.unshift(...j.value.splice(l,1))},j=o([]),q=async()=>{const e=await L.cateProduct({orderId:c.value,cateId:r.name});0===e.code&&(j.value=e.data,j.value.forEach((e=>{e.pon=!1})))},M=e=>{i.value=!!e},V=[{message:"请选择产品类别",required:!0,key:"name"},{message:"请选择产品品牌",required:!0,key:"type"},{message:"请输入产品数量",required:!0,key:"number"}],D=o(!0),E=async()=>{if(e=r,V.some((l=>!(!l.required||e[l.key]||(J(l.message),0)))))return;var e;r.number<=0&&J("数量需要 > 0"),r.number>=1e4&&J("数量小于 < 10000");const l=f.value.find((e=>e.id===r.name)),n=j.value.find((e=>e.id===r.type));l.on=!1,l.num=Number(r.number),n.pon=!0,l.product=j.value,G("插入成功"),M(!1),a("doSth",l)};return l({display:M}),(e,l)=>{const a=O,n=P,o=A;return v(),w(o,{show:u(i),"onUpdate:show":l[10]||(l[10]=e=>x(i)?i.value=e:null),closeable:"",position:"bottom",round:"","safe-area-inset-bottom":"",onOpen:C},{default:b((()=>[d("div",ye,[pe,d("div",he,[y(z,null,{default:b((()=>[y(a,{modelValue:u(m).name,"onUpdate:modelValue":l[0]||(l[0]=e=>u(m).name=e),"is-link":"",readonly:"",required:"",name:"picker",class:"input",label:"产品类别",placeholder:"请选择产品类别","input-align":"right",onClick:l[1]||(l[1]=e=>p.value=!0)},null,8,["modelValue"])])),_:1}),u(m).name?(v(),w(z,{key:0},{default:b((()=>[y(a,{modelValue:u(m).type,"onUpdate:modelValue":l[2]||(l[2]=e=>u(m).type=e),"is-link":"",readonly:"",required:"",name:"picker",class:"input",label:"产品品牌",placeholder:"请选择产品品牌","input-align":"right",onClick:l[3]||(l[3]=e=>I.value=!0)},null,8,["modelValue"])])),_:1})):g("",!0),u(m).name&&u(m).type?(v(),w(z,{key:1},{default:b((()=>[y(a,{modelValue:u(r).number,"onUpdate:modelValue":l[4]||(l[4]=e=>u(r).number=e),modelModifiers:{trim:!0},required:"",maxlength:"20",class:"input",type:"digit",min:1,label:"产品数量",placeholder:"请输入产品数量","input-align":"right"},null,8,["modelValue"])])),_:1})):g("",!0)])]),d("div",ge,[d("div",{onClick:l[5]||(l[5]=e=>M(!1))}," 取消 "),u(D)?(v(),s("div",{key:0,onClick:E}," 新增 ")):(v(),s("div",_e," 新增中... "))]),y(o,{show:u(p),"onUpdate:show":l[7]||(l[7]=e=>x(p)?p.value=e:null),position:"bottom"},{default:b((()=>[y(n,{columns:u(f),"columns-field-names":h,onConfirm:_,onCancel:l[6]||(l[6]=e=>p.value=!1)},null,8,["columns"])])),_:1},8,["show"]),y(o,{show:u(I),"onUpdate:show":l[9]||(l[9]=e=>x(I)?I.value=e:null),position:"bottom"},{default:b((()=>[y(n,{columns:u(j),"columns-field-names":W,onConfirm:S,onCancel:l[8]||(l[8]=e=>I.value=!1)},null,8,["columns"])])),_:1},8,["show"])])),_:1},8,["show"])}}}),[["__scopeId","data-v-ab477a50"]]),ke=e=>(_("data-v-bfbbc9fe"),e=e(),f(),e),we={class:"inventory"},be={key:0,class:"table"},xe={class:"header"},Ce={class:"top"},Ie=ke((()=>d("div",{class:"col0"}," 操作 ",-1))),We=["onClick"],Se=ke((()=>d("div",{class:"col0"},[d("img",{src:"/assets/setting-7357981a.png"})],-1))),je=["src"],qe={key:0},Me=["src"],Ve=["src"],De=["src"],Ee={key:0},Fe=["src"],Ne=["onClick"],Ue=["src"],Be=["onClick"],ze=["src"],Pe=["onClick"],Oe=["src"],Le=["onClick"],Ae=["src"],Je=["onClick"],Ge=["src"],Re=["onClick"],Te=["src"],$e={class:"cob4_box"},He=a({__name:"edit",props:{columns:{},id:{}},emits:["click"],setup(e,{emit:l}){const a=e,_=C(),{columns:f}=n(a),k=()=>{l("click",f.value)},b=f.value.map((()=>o(null))),x=e=>l=>{b[e].value=l},W=t((()=>{const e=b.map((e=>e.value?[e.value.querySelector(".col1")?.clientWidth||0,e.value.querySelector(".col2")?.clientWidth||0,e.value.querySelector(".col3")?.clientWidth||0,e.value.querySelector(".col4")?.clientWidth||0,e.value.querySelector(".col5")?.clientWidth||0]:[0,0])),l=Math.max(...e.map((([e])=>e))),a=Math.max(...e.map((([,e])=>e))),n=Math.max(...e.map((([,,e])=>e))),o=Math.max(...e.map((([,,,e])=>e))),t=Math.max(...e.map((([,,,,e])=>e)));return[l,a,n,o,t,l+a+n+o+t]})),S=o(!1);i((()=>{S.value=!0,_.maxColumnWidth=W.value}));const j=e=>{(e=>{if(e>0){const l=f.value.splice(e,1)[0];f.value.splice(e-1,0,l)}})(e),k()},q=e=>{(e=>{if(e<f.value.length-1){const l=f.value.splice(e,1)[0];f.value.splice(e+1,0,l)}})(e),k()},M=e=>{(e=>{f.value.splice(e,1)})(e),b.value=_.maxColumnWidth,k()},V=()=>{k()},D=o([]),E=o(),N=(e,l)=>{D.value=[e,l],E.value.display(!0)},U=o(!0),z=e=>{if(D.value[1]&&0===D.value[0])f.value.unshift(e),b.unshift(o(null));else{const l=D.value[1]?D.value[0]:D.value[0]+1;f.value.splice(l,0,e),b.splice(l,0,o(null))}k()};return(e,l)=>{const a=F,n=B;return v(),s("div",we,[u(U)?(v(),s("ul",be,[d("li",xe,[d("div",Ce,[Ie,d("div",{class:"col1",style:c({width:u(S)?u(_).maxColumnWidth[0]/100+"rem":"auto"})}," 产品类别 ",4),d("div",{class:"col2",style:c({width:u(S)?u(_).maxColumnWidth[1]/100+"rem":"auto"})}," 品牌 ",4),d("div",{class:"col3",style:c({width:u(S)?u(_).maxColumnWidth[2]/100+"rem":"auto"})}," 缩略图 ",4),d("div",{class:"col4",style:c({width:u(S)?u(_).maxColumnWidth[3]/100+"rem":"auto"})}," 售价/单位 ",4),d("div",{class:"col5",style:c({width:u(S)?u(_).maxColumnWidth[4]/100+"rem":"auto"})}," 数量 ",4)])]),(v(!0),s(m,null,r(u(f),((e,l)=>(v(),s("li",{key:l,ref_for:!0,ref:"columnDivs",class:"body"},[d("div",{ref_for:!0,ref:x(l),class:"top",onClick:l=>(e=>{e.on=!e.on})(e)},[Se,d("div",{class:"col1",style:c({width:u(S)?u(_).maxColumnWidth[0]/100+"rem":"auto"})},[p(h(e.name)+" ",1),d("img",{src:e.on?u(_).getImage("home/don.png"):u(_).getImage("home/up.png")},null,8,je)],4),d("div",{class:"col2",style:c({width:u(S)?u(_).maxColumnWidth[1]/100+"rem":"auto"})},[e.product.length?(v(),s("span",qe,h(e.product[0].brand),1)):g("",!0),d("img",{src:e.on?u(_).getImage("home/don.png"):u(_).getImage("home/up.png")},null,8,Me)],4),d("div",{class:"col3",style:c({width:u(S)?u(_).maxColumnWidth[2]/100+"rem":"auto"})},[e.product.length?(v(),s("img",{key:0,class:"shopImg",src:e.product[0].img},null,8,Ve)):g("",!0),d("img",{src:e.on?u(_).getImage("home/don.png"):u(_).getImage("home/up.png")},null,8,De)],4),d("div",{class:"col4",style:c({width:u(S)?u(_).maxColumnWidth[3]/100+"rem":"auto"})},[e.product.length?(v(),s("span",Ee," ¥"+h(e.product[0].price/100)+"/"+h(e.product[0].unit),1)):g("",!0)],4),d("div",{class:"col5",style:c({width:u(S)?u(_).maxColumnWidth[4]/100+"rem":"auto"})},[p(h(e.num)+" ",1),d("img",{src:e.on?u(_).getImage("home/don.png"):u(_).getImage("home/up.png")},null,8,Fe)],4)],8,We),e.on?(v(),s("div",{key:0,class:"bottom",style:c({width:u(S)?(u(_).maxColumnWidth[5]+42)/100+"rem":"100%"})},[d("div",{class:"cob0",style:c({width:u(S)?(u(_).maxColumnWidth[0]+42)/100+"rem":"auto"})},[d("div",{onClick:e=>N(l,!0)},[d("img",{src:u(_).getImage("home/ct.png")},null,8,Ue),p(" 上面插入产品 ")],8,Ne),d("div",{onClick:e=>N(l,!1)},[d("img",{src:u(_).getImage("home/cb.png")},null,8,ze),p(" 下面插入产品 ")],8,Be),d("div",{onClick:e=>j(l)},[d("img",{src:u(_).getImage("home/top.png")},null,8,Oe),p(" 上移一位 ")],8,Pe),d("div",{onClick:e=>q(l)},[d("img",{src:u(_).getImage("home/bottom.png")},null,8,Ae),p(" 上移一位 ")],8,Le),d("div",{onClick:e=>M(l)},[d("img",{src:u(_).getImage("home/delete.png")},null,8,Ge),p(" 删除 ")],8,Je)],4),d("div",{class:"cob1",style:c({width:u(S)?u(_).maxColumnWidth[1]/100+"rem":"auto"})},[(v(!0),s(m,null,r(e.product,((l,n)=>(v(),s("div",{key:n,class:I(l.pon?"nameActive":""),onClick:l=>((e,l)=>{((e,l)=>{e.forEach((e=>{e.pon=e.id===l.id}));const a=e.findIndex((e=>e.id===l.id));0!==a&&-1!==a&&e.unshift(...e.splice(a,1))})(e,e[l]),k()})(e.product,n)},[d("span",null,h(l.brand),1),l.pon?(v(),w(a,{key:0,name:"success",color:"#4775EB"})):g("",!0)],10,Re)))),128))],4),d("div",{class:"cob2",style:c({width:u(S)?u(_).maxColumnWidth[2]/100+"rem":"auto"})},[(v(!0),s(m,null,r(e.product,((e,l)=>(v(),s("div",{key:l},[d("img",{src:e.img},null,8,Te)])))),128))],4),d("div",{class:"cob3",style:c({width:u(S)?u(_).maxColumnWidth[3]/100+"rem":"auto"})},null,4),d("div",{class:"cob4",style:c({width:u(S)?u(_).maxColumnWidth[4]/100+"rem":"auto"})},[d("div",$e,[y(n,{modelValue:e.num,"onUpdate:modelValue":l=>e.num=l,class:"van-stepper","disable-input":"",min:"1",max:"999",onChange:V},null,8,["modelValue","onUpdate:modelValue"])])],4)],4)):g("",!0)])))),128))])):g("",!0),e.id?(v(),w(fe,{key:1,id:e.id,ref_key:"childProfit",ref:E,onDoSth:z},null,8,["id"])):g("",!0)])}}}),Ke=N(He,[["__scopeId","data-v-bfbbc9fe"]]),Qe=e=>(_("data-v-4d89091d"),e=e(),f(),e),Xe={class:"money"},Ye=Qe((()=>d("span",null,"¥",-1))),Ze={key:0,class:"bottom"},el=[Qe((()=>d("div",null,[d("span",null,"主要信息：包含设备、运输费用、不含税")],-1))),Qe((()=>d("div",null,[d("span",null,"备注说明：所有产品均为原厂正品，智能家居设备支持互联互通、远程控制及场景自动化")],-1)))],ll={class:"money"},al={class:"cost"},nl={class:"rightBox"},ol={class:"titlar"},tl=Qe((()=>d("span",null,"¥",-1))),il=[Qe((()=>d("img",{src:q},null,-1)))],sl={key:0,class:"bottom"},dl=[Qe((()=>d("div",null,[d("span",null,"主要信息：设备总金额 x 20%")],-1))),Qe((()=>d("div",null,[d("span",null,"备注说明：包含安装所需的辅材、人工、app配置、设备配网、场景调试费用")],-1)))],cl={class:"money"},ul={class:"cost"},ml={class:"rightBox"},rl={class:"titlar"},vl=Qe((()=>d("span",null,"¥",-1))),yl=[Qe((()=>d("img",{src:q},null,-1)))],pl={key:0,class:"bottom"},hl=[Qe((()=>d("div",null,[d("span",null,"主要信息：面积 x 50元/平方")],-1))),Qe((()=>d("div",null,[d("span",null,"备注说明：根据CAD图纸，提供灯光场景设计，输出灯具点位、选型等图纸清单")],-1)))],gl={class:"money"},_l={style:{color:"#4775EB"}},fl=Qe((()=>d("span",null,"¥",-1))),kl={key:0,class:"bottom"},wl=[Qe((()=>d("div",null,[d("span",null,"主要信息：含设备、运输、安装、调试")],-1))),Qe((()=>d("div",null,[d("span",null,"备注说明：定金50%，主材安装阶段设备进场前支付45%，配网调试当天支付5%。不含税")],-1)))],bl=a({__name:"money",props:{money:{},edit:{}},emits:["click"],setup(e,{emit:l}){const a=e,{money:t,edit:i}=n(a),c=()=>{t.value.all_money=t.value.money+t.value.de_money+t.value.design_money,l("click",t.value)},m=o([!1,!1,!1,!1]),r=e=>{m.value[e]=!m.value[e]},_=o(),f=()=>{_.value.display(!0)},k=e=>{t.value.de_money=Number(e),c()},b=o(),x=()=>{b.value.display(!0)},C=e=>{t.value.design_money=Number(e),c()};return(e,l)=>{const a=F;return v(),s("div",null,[d("div",Xe,[d("div",{class:"cost",onClick:l[0]||(l[0]=e=>r(0))},[d("div",null,[y(a,{name:u(m)[0]?"arrow-up":"arrow-down",size:"0.12rem",color:"#273545"},null,8,["name"]),p(" 智能家居设备总计金额 ")]),d("div",null,[Ye,p(h(u(t).money.toFixed(2)),1)])]),u(m)[0]?(v(),s("div",Ze,el)):g("",!0)]),d("div",ll,[d("div",al,[d("div",{onClick:l[1]||(l[1]=e=>r(1))},[y(a,{name:u(m)[1]?"arrow-up":"arrow-down",size:"0.12rem",color:"#273545"},null,8,["name"]),p(" 设备安装、配网调试费 ")]),d("div",nl,[d("div",ol,[tl,p(h(u(t).de_money.toFixed(2)),1)]),u(i)?g("",!0):(v(),s("div",{key:0,class:"showEdit",onClick:f},il))])]),u(m)[1]?(v(),s("div",sl,dl)):g("",!0)]),d("div",cl,[d("div",ul,[d("div",{onClick:l[2]||(l[2]=e=>r(2))},[y(a,{name:u(m)[2]?"arrow-up":"arrow-down",size:"0.12rem",color:"#273545"},null,8,["name"]),p(" 智能灯光标准设计 ")]),d("div",ml,[d("div",rl,[vl,p(h(u(t).design_money.toFixed(2)),1)]),u(i)?g("",!0):(v(),s("div",{key:0,class:"showEdit",onClick:x},yl))])]),u(m)[2]?(v(),s("div",pl,hl)):g("",!0)]),d("div",gl,[d("div",{class:"cost",onClick:l[3]||(l[3]=e=>r(3))},[d("div",null,[y(a,{name:u(m)[3]?"arrow-up":"arrow-down",size:"0.12rem",color:"#273545"},null,8,["name"]),p(" 总金额 ")]),d("div",_l,[fl,p(h(u(t).all_money.toFixed(2)),1)])]),u(m)[3]?(v(),s("div",kl,wl)):g("",!0)]),u(t)?(v(),w(j,{key:0,ref_key:"childMoneya",ref:_,money:u(t).de_money,type:"de_money",onDoSthMoney:k},null,8,["money"])):g("",!0),u(t)?(v(),w(j,{key:1,ref_key:"childMoneyb",ref:b,money:u(t).design_money,type:"design_money",onDoSthMoney:C},null,8,["money"])):g("",!0)])}}}),xl=N(bl,[["__scopeId","data-v-4d89091d"]]),Cl=e=>(_("data-v-2503a53b"),e=e(),f(),e),Il={class:"box"},Wl=["src"],Sl=["src"],jl=["src"],ql={key:1,class:"main"},Ml={class:"custom-indicator"},Vl={class:"header"},Dl={class:"header_name"},El={class:"header_time"},Fl={class:"mainBody"},Nl={class:"main_box"},Ul=["src"],Bl={key:4,class:"cost"},zl=Cl((()=>d("div",null,"渠道采购总成本",-1))),Pl={key:0},Ol=Cl((()=>d("span",null,"¥",-1))),Ll={key:1},Al=Cl((()=>d("span",null,"¥",-1))),Jl={key:6,class:"cost"},Gl=Cl((()=>d("div",null," 报价整体毛利设置 ",-1))),Rl={class:"rightBox"},Tl={class:"titlar"},$l=Cl((()=>d("span",null,"%",-1))),Hl=[Cl((()=>d("img",{src:q},null,-1)))],Kl={class:"footer"},Ql={key:1},Xl=a({__name:"index",setup(e){const l=C(),a=W(),n=S(),t=a.query?.id,i=a.query?.type,c=()=>{"1"===i?n.push({path:"/home"}):n.push({path:"/record"})},_=()=>{n.push({path:"/record",query:{type:1,id:t}})},f=()=>{n.push({path:"/home"})},x=o([]),I=k({loadingShow:!1}),q=o({}),F=o({}),N=k({money:0,de_money:0,design_money:0,all_money:0,cost_money:0,profit:0}),B=o(null),z=o([]),P=async()=>{I.loadingShow=!0;const e=await L.info({id:t});0===e.code&&(x.value=[],x.value.push(e.data.order.img),q.value=e.data.order,N.money=e.data.order.money/100,N.de_money=e.data.order.de_money/100,N.design_money=e.data.order.design_money/100,N.all_money=e.data.order.all_money/100,N.cost_money=e.data.order.cost_money/100,N.profit=e.data.order.profit,B.value={...N},F.value=e.data.style,z.value=JSON.parse(e.data.order.content),z.value.forEach((e=>{e.on=!1,e.product.forEach(((e,l)=>{e.pon=0===l}))}))),I.loadingShow=!1};P();const O=(e,l)=>{let a=0;for(const n of e)a+=n.product.filter((e=>e.pon)).reduce(((e,a)=>e+a[l]*n.num),0);return a/100},A=o(!1),Y=e=>{A.value=!0,z.value=e,B.value.cost_money=O(e,"costPrice"),B.value.money=O(z.value,"price"),B.value.de_money=.2*B.value.money,B.value.design_money=50*q.value.area,B.value.all_money=B.value.money+B.value.de_money+B.value.design_money},Z=o(),ee=()=>{Z.value.display(!0)},le=e=>{B.value.profit=e,te()},ae=e=>{B.value.de_money=e.de_money,B.value.design_money=e.design_money},ne=o(!0),oe=()=>{ne.value=!1},te=async()=>{if(B.value.profit<20||B.value.profit>80)return void J("报价整体毛利率需 >= 20 并且 <= 80");const e={id:t,content:JSON.stringify(z.value),profit:B.value.profit,de_money:Number(100*B.value.de_money).toFixed(0),design_money:Number(B.value.design_money).toFixed(0)};!1===A.value&&delete e.content,N.profit==B.value.profit&&delete e.profit,N.de_money==B.value.de_money&&delete e.de_money,N.design_money==B.value.design_money&&delete e.design_money,console.log(e),R({message:"保存中...",forbidClick:!0}),0===(await L.save(e)).code&&(G("保存成功"),P(),ne.value=!0,T())},ie=o(),se=()=>{ie.value.display(!0)},de=async()=>{R({message:"导出PDF中...",forbidClick:!0,duration:0});const e=await L.pdf({orderId:t});0===e.code&&(window.open(e.data),G("导出成功"))};return(e,a)=>{const n=U,o=X,i=Q,k=K,C=D;return v(),s("div",Il,[y(n,{class:"nav",title:"详情",fixed:"",placeholder:"","safe-area-inset-top":"","left-arrow":"",onClickLeft:c},{right:b((()=>[d("img",{style:{width:"0.26rem",height:"0.26rem","margin-right":"0.15rem"},src:u(l).getImage("home/excel.png"),onClick:de},null,8,Wl),d("img",{style:{width:"0.26rem",height:"0.26rem","margin-right":"0.15rem"},src:u(l).getImage("home/menus.png"),onClick:_},null,8,Sl),d("img",{style:{width:"0.26rem",height:"0.26rem"},src:u(l).getImage("home/me.png"),onClick:f},null,8,jl)])),_:1}),u(I).loadingShow?(v(),w(E,{key:0})):(v(),s("div",ql,[y(k,{class:"banner",autoplay:3e3,"lazy-render":""},{indicator:b((({active:e,total:l})=>[d("div",Ml,h(e+1)+"/"+h(l),1)])),default:b((()=>[(v(!0),s(m,null,r(u(x),(e=>(v(),w(i,{key:e},{default:b((()=>[y(o,{width:"100%",height:"1.99rem",src:e},null,8,["src"])])),_:2},1024)))),128))])),_:1}),d("div",Vl,[d("div",Dl,h(u(q).name),1),d("div",El,[y(o,{width:"0.15rem",height:"0.15rem",src:u(l).getImage("home/time.png")},null,8,["src"]),d("span",null,h(u(H)(Number(u(q).add_time),"yyyy-MM-dd",1)),1)])]),d("div",Fl,[d("div",Nl,[y(M,{title:"智能产品清单",font:"0.18rem",padding:"0.27rem 0 0.1rem 0"}),u(ne)?(v(),w(ve,{key:0,columns:u(z)},null,8,["columns"])):(v(),w(Ke,{key:1,id:u(t),columns:u(z),onClick:Y},null,8,["id","columns"])),y(M,{title:"装修风格",tips:`(${u(F).name})`},null,8,["tips"]),u(q)?(v(),s("iframe",{key:2,class:"ifam",src:u(F).url},null,8,Ul)):g("",!0),y(M,{title:"价格明细"}),y(xl,{money:u(B),edit:u(ne),onClick:ae},null,8,["money","edit"]),1===u(l).info_data.show_money||0===u(l).info_data.show_money&&!u(ne)?(v(),w(M,{key:3,title:"成本明细",tips:"(分享不可见)"})):g("",!0),1===u(l).info_data.show_money||0===u(l).info_data.show_money&&!u(ne)?(v(),s("div",Bl,[zl,u(ne)?(v(),s("div",Pl,[Ol,p(h(u(B).cost_money),1)])):(v(),s("div",Ll,[Al,p(h(u(B).cost_money),1)]))])):g("",!0),u(ne)?g("",!0):(v(),w(M,{key:5,title:"毛利率",tips:"(分享不可见)"})),u(ne)?g("",!0):(v(),s("div",Jl,[Gl,d("div",Rl,[d("div",Tl,[p(h(u(B).profit),1),$l]),u(ne)?g("",!0):(v(),s("div",{key:0,class:"showEdit",onClick:ee},Hl))])]))])]),y(C),u(q).ai_content?(v(),w(V,{key:0,name:u(q).ai_content},null,8,["name"])):g("",!0),d("div",Kl,[u(l).info_data.level>=1&&1==u(q).status&&u(q).share_code?(v(),s("div",{key:0,onClick:se},"分享")):g("",!0),u(l).info_data.level>1||u(l).info_data.level<=1&&0==u(q).status?(v(),s("div",Ql,[u(ne)?(v(),s("div",{key:0,onClick:oe}," 编辑 ")):(v(),s("div",{key:1,onClick:te}," 保存 "))])):g("",!0)])])),u(q).share_code?(v(),w($,{key:2,ref_key:"childInvite",ref:ie,"invite-code":u(q).share_code,type:1},null,8,["invite-code"])):g("",!0),u(B)?(v(),w(j,{key:3,ref_key:"childMoney",ref:Z,money:u(B).profit,type:"profit",onDoSthMoney:le},null,8,["money"])):g("",!0)])}}});e("default",N(Xl,[["__scopeId","data-v-2503a53b"]]))}}}));
